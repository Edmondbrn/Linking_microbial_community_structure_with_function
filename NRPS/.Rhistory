#Import data
Rarefied_physeq_mean_rounded_rhizoplane<-readRDS("ressources/RDS/Rarefied_physeq_mean_rounded_rhizoplane.rds")
alpha_div_plane = estimate_richness(Rarefied_physeq_mean_rounded_rhizoplane, measures = c("Shannon", "Chao1")) # compute alpha diversity
alpha_div_plane = cbind(alpha_div_plane, Rarefied_physeq_mean_rounded_rhizoplane@sam_data) # add the factor to the new table
alpha_div_plane$WEEK = gsub("(\\d)(weeks)", "\\1 \\2", alpha_div_plane$WEEK) # add a space between the week number and the word WEEK
# subset control plants (watered)
alpha_div_ctrl<- rbind(alpha_div_plane,alpha_div_sphere) %>% filter(Irrigation %in% "Watered")
# alpha diversity and richness. Use the rmd for background calculations
library(tidyverse)
# subset control plants (watered)
alpha_div_ctrl<- rbind(alpha_div_plane,alpha_div_sphere) %>% filter(Irrigation %in% "Watered")
#Import data
Rarefied_physeq_mean_rounded_rhizoplane<-readRDS("ressources/RDS/Rarefied_physeq_mean_rounded_rhizoplane.rds")
alpha_div_plane = estimate_richness(Rarefied_physeq_mean_rounded_rhizoplane, measures = c("Shannon", "Chao1")) # compute alpha diversity
alpha_div_plane = cbind(alpha_div_plane, Rarefied_physeq_mean_rounded_rhizoplane@sam_data) # add the factor to the new table
alpha_div_plane$WEEK = gsub("(\\d)(weeks)", "\\1 \\2", alpha_div_plane$WEEK) # add a space between the week number and the word WEEK
alpha_div_plane
alpha_div_plane$Irrigation<-gsub("Watered","Control",alpha_div_plane$Irrigation)
alpha_div_plane$Compartments<-gsub("r","R",alpha_div_plane$Compartments)
symnum.args2 <- list(cutpoints = c(0,  0.001, 0.01, 0.05, Inf), symbols = c( "***", "**", "*", "ns"))
Shan_plot_rp<-alpha_div_plane %>% ggplot(aes(x = Irrigation, y = Shannon))+geom_point() +
facet_grid(~ WEEK, scales = "free_x") + #organise the plot by week
theme_bw() +theme(axis.title.x =element_blank(), legend.position = "none", panel.grid = element_blank(),
axis.text = element_text(size = 10), axis.title = element_text (size = 12, face = "bold"),
strip.background = element_rect(fill="white", color = "black"),
strip.text = element_text(size =12))+
scale_y_continuous(breaks = c(6,6.5,7,7.5), limits = c(6,7.5), expand = c(0,0))+
stat_compare_means(aes(group = Irrigation), label = "p.signif",
method = "t.test", symnum.args = symnum.args2 , label.y =7.4, label.x = 1.4)
library(tidyverse)
library(ggplot2)
library(ggpubr)
Shan_plot_rp<-alpha_div_plane %>% ggplot(aes(x = Irrigation, y = Shannon))+geom_point() +
facet_grid(~ WEEK, scales = "free_x") + #organise the plot by week
theme_bw() +theme(axis.title.x =element_blank(), legend.position = "none", panel.grid = element_blank(),
axis.text = element_text(size = 10), axis.title = element_text (size = 12, face = "bold"),
strip.background = element_rect(fill="white", color = "black"),
strip.text = element_text(size =12))+
scale_y_continuous(breaks = c(6,6.5,7,7.5), limits = c(6,7.5), expand = c(0,0))+
stat_compare_means(aes(group = Irrigation), label = "p.signif",
method = "t.test", symnum.args = symnum.args2 , label.y =7.4, label.x = 1.4)
# ======================= Beta diversity ====================================
plot_pcoa = function(data, color,  Shape, filename){
list_output = list() # to return the plot and the beta diversity results
print("Computing PCoA")
physeq.ord_pcoa = ordinate(data, "PCoA", "bray")
print("Plotting PCoA")
p3 = plot_ordination(data, physeq.ord_pcoa, shape = Shape) +
scale_color_manual(values=c("#018571","#a6611a"),name = "Irrigation") +
geom_point(size = 4, aes(color = !!sym(color))) +  # Use aes with sym
theme_bw() +
theme(axis.text = element_text(size = 10, face = "bold"), axis.title = element_text(size = 12, face = "bold"),
legend.text = element_text(size = 11), legend.title = element_text(size = 13),
panel.grid = element_blank())
ggsave(filename)
list_output[[1]] = p3
list_output[[2]] = physeq.ord_pcoa
return(list_output)
}
#Import data
p4<- plot_pcoa(Rarefied_physeq_mean_rounded_rhizoplane, "Irrigation",  "WEEK", "output/PCoA_NRPS_rp.png")
pcoa_NRPS_rp<-p4[[1]]
#Extract the legend
pcoa_legend<-get_legend(pcoa_NRPS_rp)
leg_for_plot<-ggarrange(pcoa_legend)
p3<-pcoa_NRPS_rp+theme(legend.position = "none")
library(patchwork)
all_plots_t<-Shan_plot_rp+p3+leg_for_plot+patchwork::plot_layout(widths = c(3,2,1))
all_plots_t[[3]]<-all_plots_t[[3]]+plot_layout(tag_level ='new')
all_plots_t+patchwork::plot_annotation(tag_levels = ("A"))
x11(width = 8, height = 4)
all_plots_t+patchwork::plot_annotation(tag_levels = ("A"))
rhizoplane_NRPS<-readRDS("ressources/RDS/raw_physeq_rhizoplane.rds")
rhizoplane_NRPS
alpha_div_plane
library(phyloseq)
?subset_samples
sample_data(rhizoplane_NRPS)
# Subset control
rhizoplane_NRPS_co<-subset_samples(rhizoplane_NRPS, Treatment %in% "Control")
rhizoplane_NRPS_co
rhizoplane_NRPS_co<-prune_taxa(taxa_sums(rhizoplane_NRPS_co)>0,rhizoplane_NRPS_co)
rhizoplane_NRPS_co
min(sample_sums(rhizoplane_NRPS_co))
max(sample_sums(rhizoplane_NRPS_co))
median(sample_sums(rhizoplane_NRPS_co))
total(sample_sums(rhizoplane_NRPS_co))
sum(sample_sums(rhizoplane_NRPS_co))
# Here, the taxonomic proportions of assigned reads are visualised - Might need to go back in to analysis_NRPS_amplicon_edited_by_FB.rmd"
# for more details and background files
library(tidyverse)
library(ggplot2)
plot_annotation = function(data, type){
colors = c("#66c2a5", "#fc8d62", "#8da0cb", "#e78ac3", "#a6d854", "#ffd92f", "#e5c494", "#b3b3b3")
ggplot(data = data, aes(x = 2, y = Freq, fill = Var1))+
geom_bar(stat = "identity", width = 1, color = "black") +
coord_polar(theta = "y") + # line to remove to have a stacked barplot
xlim(0.5, 2.5) +
geom_text(aes(label = paste0(round(Freq, 3), "%")),
position = position_stack(vjust = 0.5)) +
theme_void() +
theme(legend.position = "right", legend.text = element_text(size = 15)) +
labs(fill = "ASV")+
scale_fill_manual(values = colors) # Utilisation de la palette de couleurs
}
compute_freq = function (data){ # fonction to select and compute the proportion of annotated clusters in the data
asv_table = otu_table(data)
asv_table = asv_table[rowSums(asv_table)>0,]
asv_present = rownames(asv_table)
taxonomy_table = tax_table(data)
taxonomy_asv = as.data.frame(taxonomy_table[asv_present, ])
annot = as.data.frame(prop.table(table(taxonomy_asv$superkingdom)) * 100)
return(annot)
}
physeq_rhizoplane_drought<- subset_samples(physeq_rhizoplane, Irrigation %in% "Drought")
physeq_rhizoplane_watered<-subset_samples(physeq_rhizoplane, Irrigation %in% "Watered")
physeq_rhizoplane <- readRDS("resources/RDS/raw_physeq_rhizoplane.rds")
physeq_rhizoplane <- readRDS("ressources/RDS/raw_physeq_rhizoplane.rds")
physeq_rhizoplane_drought<- subset_samples(physeq_rhizoplane, Irrigation %in% "Drought")
physeq_rhizoplane_watered<-subset_samples(physeq_rhizoplane, Irrigation %in% "Watered")
annot_drought<-compute_freq(physeq_rhizoplane_drought)
annot_watered<-compute_freq(physeq_rhizoplane_watered)
# Calculate product
compute_freq_product = function (data){ # function to select and compute the proportion of annotated clusters in the data
asv_table = otu_table(data)
asv_table = asv_table[rowSums(asv_table)>0,]
asv_present = rownames(asv_table)
taxonomy_table = tax_table(data)
taxonomy_asv = as.data.frame(taxonomy_table[asv_present, ])
annot = as.data.frame(prop.table(table(taxonomy_asv$product)) * 100)
return(annot)
}
compute_freq_taxa_of_assigned = function (data,name){ # function to select and compute the proportion of annotated clusters in the data
asv_table = otu_table(data)
asv_table = asv_table[rowSums(asv_table)>0,]
asv_present = rownames(asv_table)
taxonomy_table = tax_table(data)
taxonomy_asv = as.data.frame(taxonomy_table[asv_present, ])
annot = as.data.frame(prop.table(table(taxonomy_asv$phylum)) * 100)
colnames(annot) = c("Phylum",name)
return(annot)
}
physeq_rp_dr_assi<-subset_taxa(physeq_rhizoplane_drought, !product == "unassigned" )
physeq_rp_dr_assi<-prune_taxa(taxa_sums(physeq_rp_dr_assi) > 0, physeq_rp_dr_assi)
physeq_rp_dr_assi_w4<-physeq_rp_dr_assi %>% subset_samples(WEEK %in% "4weeks")
sample_data(physeq_rp_dr_assi)
physeq_rp_dr_assi_w4<-physeq_rp_dr_assi %>% subset_samples(WEEK %in% "week 4")
physeq_rp_dr_assi_w5<-physeq_rp_dr_assi %>% subset_samples(!WEEK %in% "week 4")
annot_phyl_rp_dr_w4<-compute_freq_taxa_of_assigned(physeq_rp_dr_assi_w4,"W4 D")
annot_phyl_rp_dr_w5<-compute_freq_taxa_of_assigned(physeq_rp_dr_assi_w5,"W5 D")
annot_phyl_rp_dr_w4
physeq_rp_ww_assi<-subset_taxa(physeq_rhizoplane_watered, !product == "unassigned" )
physeq_rp_ww_assi <-physeq_rp_ww_assi %>% subset_samples(Treatment %in% "Control")
physeq_rp_ww_assi <-prune_taxa(taxa_sums(physeq_rp_ww_assi ) > 0, physeq_rp_ww_assi )
physeq_rp_ww_assi_w4<-physeq_rp_ww_assi %>% subset_samples(WEEK %in% "week 4")
physeq_rp_ww_assi_w5<-physeq_rp_ww_assi %>% subset_samples(!WEEK %in% "week 4")
annot_phyl_rp_ww_w4<-compute_freq_taxa_of_assigned(physeq_rp_ww_assi_w4,"W4 C")
annot_phyl_rp_ww_w5<-compute_freq_taxa_of_assigned(physeq_rp_ww_assi_w5,"W5 C")
#Include week 2
physeq_rp_ww_assi_w2<-physeq_rp_ww_assi %>% subset_samples(WEEK %in% "week 2")
annot_phyl_rp_ww_w2<-compute_freq_taxa_of_assigned(physeq_rp_ww_assi_w2,"W2 C")
#Combined verything for easier plotting
list_dfs<-list(annot_phyl_rp_dr_w4,annot_phyl_rp_dr_w5,annot_phyl_rp_ww_w4,annot_phyl_rp_ww_w5, annot_phyl_rp_ww_w2)
combined_dfs<-list_dfs %>% reduce(full_join, by='Phylum') %>% pivot_longer(!Phylum,names_to = "Treatment",values_to = "Proportion")
annotated_proportions<-ggplot(combined_dfs, aes(x = Treatment, y = Proportion, fill = Phylum)) + geom_bar(position="fill", stat="identity")+
theme_bw()+
theme(legend.position = "right", legend.text = element_text(size = 10),
axis.text.x = element_text(size = 8)) +
scale_fill_manual(values =   c("#66c2a5", "#fc8d62", "#8da0cb", "#e78ac3", "#a6d854", "#ffd92f", "#e5c494", "#b3b3b3"))
annotated_proportions
combined_dfs
combined_dfs # Proportion of NRPS for each phylum
View(combined_dfs)
combined_dfs$Phylum[combined_dfs$Phylum %in% "Pseudomonadota"]<-"Proteobacteria"
combined_dfs$Phylum
combined_dfs<-list_dfs %>% reduce(full_join, by='Phylum') %>% pivot_longer(!Phylum,names_to = "Treatment",values_to = "Proportion")
combined_dfs$Phylum[combined_dfs$Phylum %in% "Pseudomonadota"]
combined_dfs$Phylum[combined_dfs$Phylum %in% "Pseudomonadota"]
combined_dfs$Phylum[combined_dfs$Phylum %in% "Pseudomonadota"]<-"Proteobacteria"
combined_dfs<-list_dfs %>% reduce(full_join, by='Phylum') %>% pivot_longer(!Phylum,names_to = "Treatment",values_to = "Proportion")
combined_dfs$Phylum<-gsub("Pseudomonadota","Proteobacteria",combined_dfs$Phylum)
combined_dfs$Phylum
annotated_proportions<-ggplot(combined_dfs, aes(x = Treatment, y = Proportion, fill = Phylum)) + geom_bar(position="fill", stat="identity")+
theme_bw()+
theme(legend.position = "right", legend.text = element_text(size = 10),
axis.text.x = element_text(size = 8)) +
scale_fill_manual(values =   c("#66c2a5", "#fc8d62", "#8da0cb", "#e78ac3", "#a6d854", "#ffd92f", "#e5c494", "#b3b3b3"))
annotated_proportions
annotated_proportions<-ggplot(combined_dfs, aes(x = Treatment, y = Proportion, fill = Phylum)) + geom_bar(position="fill", stat="identity")+
theme_bw()+
theme(legend.position = "right", legend.text = element_text(size = 10),
panel.grid = element_blank()
axis.text.x = element_text(size = 8)) +
annotated_proportions<-ggplot(combined_dfs, aes(x = Treatment, y = Proportion, fill = Phylum)) + geom_bar(position="fill", stat="identity")+
theme_bw()+
theme(legend.position = "right", legend.text = element_text(size = 10),
panel.grid = element_blank()
axis.text.x = element_text(size = 8)) +
annotated_proportions<-ggplot(combined_dfs, aes(x = Treatment, y = Proportion, fill = Phylum)) + geom_bar(position="fill", stat="identity")+
theme_bw()+
theme(legend.position = "right", legend.text = element_text(size = 10),
panel.grid = element_blank(),
axis.text.x = element_text(size = 8)) +
scale_y_continuous(expand = c(0,0))+
scale_fill_manual(values =   c("#66c2a5", "#fc8d62", "#8da0cb", "#e78ac3", "#a6d854", "#ffd92f", "#e5c494", "#b3b3b3"))
annotated_proportions
#Import data
physeq_rhizoplane <- readRDS("ressources/RDS/Rarefied_physeq_mean_rounded_rhizoplane.rds")
physeq_rhizoplane_drought<- subset_samples(physeq_rhizoplane, Irrigation %in% "Drought")
physeq_rhizoplane_watered<-subset_samples(physeq_rhizoplane, Irrigation %in% "Watered")
annot_drought<-compute_freq(physeq_rhizoplane_drought)
annot_watered<-compute_freq(physeq_rhizoplane_watered)
# Calculate product
compute_freq_product = function (data){ # function to select and compute the proportion of annotated clusters in the data
asv_table = otu_table(data)
asv_table = asv_table[rowSums(asv_table)>0,]
asv_present = rownames(asv_table)
taxonomy_table = tax_table(data)
taxonomy_asv = as.data.frame(taxonomy_table[asv_present, ])
annot = as.data.frame(prop.table(table(taxonomy_asv$product)) * 100)
return(annot)
}
compute_freq_taxa_of_assigned = function (data,name){ # function to select and compute the proportion of annotated clusters in the data
asv_table = otu_table(data)
asv_table = asv_table[rowSums(asv_table)>0,]
asv_present = rownames(asv_table)
taxonomy_table = tax_table(data)
taxonomy_asv = as.data.frame(taxonomy_table[asv_present, ])
annot = as.data.frame(prop.table(table(taxonomy_asv$phylum)) * 100)
colnames(annot) = c("Phylum",name)
return(annot)
}
physeq_rp_dr_assi<-subset_taxa(physeq_rhizoplane_drought, !product == "unassigned" )
physeq_rp_dr_assi<-prune_taxa(taxa_sums(physeq_rp_dr_assi) > 0, physeq_rp_dr_assi)
sample_data(physeq_rp_dr_assi)
physeq_rp_dr_assi_w4<-physeq_rp_dr_assi %>% subset_samples(WEEK %in% "week 4")
physeq_rp_dr_assi_w5<-physeq_rp_dr_assi %>% subset_samples(!WEEK %in% "week 4")
annot_phyl_rp_dr_w4<-compute_freq_taxa_of_assigned(physeq_rp_dr_assi_w4,"W4 D")
physeq_rp_dr_assi<-subset_taxa(physeq_rhizoplane_drought, !product == "unassigned" )
physeq_rp_dr_assi<-prune_taxa(taxa_sums(physeq_rp_dr_assi) > 0, physeq_rp_dr_assi)
sample_data(physeq_rp_dr_assi)
physeq_rp_dr_assi_w4<-physeq_rp_dr_assi %>% subset_samples(WEEK %in% "4weeks")
physeq_rp_dr_assi_w5<-physeq_rp_dr_assi %>% subset_samples(!WEEK %in% "4weeks")
annot_phyl_rp_dr_w4<-compute_freq_taxa_of_assigned(physeq_rp_dr_assi_w4,"W4 D")
annot_phyl_rp_dr_w5<-compute_freq_taxa_of_assigned(physeq_rp_dr_assi_w5,"W5 D")
physeq_rp_ww_assi<-subset_taxa(physeq_rhizoplane_watered, !product == "unassigned" )
physeq_rp_ww_assi
physeq_rp_ww_assi <-physeq_rp_ww_assi %>% subset_samples(Treatment %in% "Control")
physeq_rp_ww_assi <-prune_taxa(taxa_sums(physeq_rp_ww_assi ) > 0, physeq_rp_ww_assi )
physeq_rp_ww_assi_w4<-physeq_rp_ww_assi %>% subset_samples(WEEK %in% "4weeks")
physeq_rp_ww_assi_w5<-physeq_rp_ww_assi %>% subset_samples(!WEEK %in% "4weeks")
annot_phyl_rp_ww_w4<-compute_freq_taxa_of_assigned(physeq_rp_ww_assi_w4,"W4 C")
annot_phyl_rp_ww_w5<-compute_freq_taxa_of_assigned(physeq_rp_ww_assi_w5,"W5 C")
#Include week 2
physeq_rp_ww_assi_w2<-physeq_rp_ww_assi %>% subset_samples(WEEK %in% "2weeks")
#Include week 2
physeq_rp_ww_assi_w2<-physeq_rp_ww_assi %>% subset_samples(WEEK %in% "2weeks")
annot_phyl_rp_ww_w2<-compute_freq_taxa_of_assigned(physeq_rp_ww_assi_w2,"W2 C")
#Combined verything for easier plotting
list_dfs<-list(annot_phyl_rp_dr_w4,annot_phyl_rp_dr_w5,annot_phyl_rp_ww_w4,annot_phyl_rp_ww_w5, annot_phyl_rp_ww_w2)
combined_dfs<-list_dfs %>% reduce(full_join, by='Phylum') %>% pivot_longer(!Phylum,names_to = "Treatment",values_to = "Proportion")
combined_dfs # Proportion of NRPS for each phylum
View(combined_dfs)
combined_dfs$Phylum<-gsub("Pseudomonadota","Proteobacteria",combined_dfs$Phylum)
annotated_proportions<-ggplot(combined_dfs, aes(x = Treatment, y = Proportion, fill = Phylum)) + geom_bar(position="fill", stat="identity")+
theme_bw()+
theme(legend.position = "right", legend.text = element_text(size = 10),
panel.grid = element_blank(),
axis.text.x = element_text(size = 8)) +
scale_y_continuous(expand = c(0,0))+
scale_fill_manual(values =   c("#66c2a5", "#fc8d62", "#8da0cb", "#e78ac3", "#a6d854", "#ffd92f", "#e5c494", "#b3b3b3"))
annotated_proportions
Rarefied_amp_mean_rp<-amp_load(physeq_rhizoplane)
library(ampvis2)
Rarefied_amp_mean_rp<-amp_load(physeq_rhizoplane)
Rarefied_amp_mean_rp$metadata$Irrigation[Rarefied_amp_mean_rp$metadata$Irrigation %in% "Watered"]<-"Control"
Rarefied_amp_mean_rp$tax$OTU<-gsub("amplicon_cluster","AC",Rarefied_amp_mean_rp$tax$OTU)
heatmap_rp<-Rarefied_amp_mean_rp%>% amp_heatmap(group_by = "Irrigation", facet_by = "WEEK",
tax_show = 25, tax_aggregate = "OTU",
tax_add = "Genus", plot_values_size = 3) + theme(axis.text.y = element_text(size=8))
heatmap_rp
heatmap_rp<-Rarefied_amp_mean_rp%>% amp_heatmap(group_by = "Irrigation", facet_by = "WEEK",
tax_show = 25, tax_aggregate = "OTU",
tax_add = "Genus", plot_values_size = 3) +
theme(axis.text.y = element_text(size=8),strip.background = element_rect(fill="white", color = "black"),
strip.text = element_text(size =12))
eatmap_rp
heatmap_rp
Rarefied_amp_mean_rp<-amp_load(physeq_rhizoplane)
Rarefied_amp_mean_rp$metadata$Irrigation[Rarefied_amp_mean_rp$metadata$Irrigation %in% "Watered"]<-"C"
Rarefied_amp_mean_rp$metadata$Irrigation[Rarefied_amp_mean_rp$metadata$Irrigation %in% "Drought"]<-"D"
Rarefied_amp_mean_rp$metadata
Rarefied_amp_mean_rp$metadata$WEEK[Rarefied_amp_mean_rp$metadata$WEEK %in% "2weeks"]<-"Week 2"
Rarefied_amp_mean_rp$metadata$WEEK[Rarefied_amp_mean_rp$metadata$WEEK %in% "4weeks"]<-"Week 4"
Rarefied_amp_mean_rp$metadata$WEEK[Rarefied_amp_mean_rp$metadata$WEEK %in% "5weeks"]<-"Week 5"
Rarefied_amp_mean_rp$tax$OTU<-gsub("amplicon_cluster","AC",Rarefied_amp_mean_rp$tax$OTU)
heatmap_rp<-Rarefied_amp_mean_rp%>% amp_heatmap(group_by = "Irrigation", facet_by = "WEEK",
tax_show = 25, tax_aggregate = "OTU",
tax_add = "Genus", plot_values_size = 3) +
theme(axis.text.y = element_text(size=8),strip.background = element_rect(fill="white", color = "black"),
strip.text = element_text(size =12))
heatmap_rp
heatmap_rp<-Rarefied_amp_mean_rp%>% amp_heatmap(group_by = "Irrigation", facet_by = "WEEK",
tax_show = 25, tax_aggregate = "OTU",
tax_add = "Genus", plot_values_size = 3,
color_vector = c("White", "Brown")) +
theme(axis.text.y = element_text(size=8),strip.background = element_rect(fill="white", color = "black"),
strip.text = element_text(size =12))
heatmap_rp
heatmap_rp<-Rarefied_amp_mean_rp%>% amp_heatmap(group_by = "Irrigation", facet_by = "WEEK",
tax_show = 25, tax_aggregate = "OTU",
tax_add = "Genus", plot_values_size = 3,
color_vector = c("White", "Brown")) +
theme(axis.text.y = element_text(size=10),strip.background = element_rect(fill="white", color = "black"),
strip.text = element_text(size =12))
heatmap_rp
Rarefied_amp_mean_rp%>% amp_heatmap(group_by = "Irrigation", facet_by = "WEEK",
tax_show = 25, tax_aggregate = "OTU",
tax_add = "Genus", plot_values_size = 3,
color_vector = c("White", "Brown")) +
theme(axis.text.y = element_text(size=10),strip.background = element_rect(fill="white", color = "black"),
strip.text = element_text(size =12), axis.text.x = element_text(angle = 45))
Rarefied_amp_mean_rp%>% amp_heatmap(group_by = "Irrigation", facet_by = "WEEK",
tax_show = 25, tax_aggregate = "OTU",
tax_add = "Genus", plot_values_size = 3,
color_vector = c("White", "Brown")) +
theme(axis.text.y = element_text(size=10),strip.background = element_rect(fill="white", color = "black"),
strip.text = element_text(size =12), axis.text.x = element_text(angle = 90))
Rarefied_amp_mean_rp%>% amp_heatmap(group_by = "Irrigation", facet_by = "WEEK",
tax_show = 25, tax_aggregate = "OTU",
tax_add = "Genus", plot_values_size = 3,
color_vector = c("White", "Brown")) +
theme(axis.text.y = element_text(size=10),strip.background = element_rect(fill="white", color = "black"),
strip.text = element_text(size =12), axis.text.x = element_text(angle = 0))
Rarefied_amp_mean_rp%>% amp_heatmap(group_by = "Irrigation", facet_by = "WEEK",
tax_show = 25, tax_aggregate = "OTU",
tax_add = "Genus", plot_values_size = 3,
color_vector = c("White", "Brown")) +
theme(axis.text.y = element_text(size=10),strip.background = element_rect(fill="white", color = "black"),
strip.text = element_text(size =12), axis.text.x = element_text(angle = 0, hjust = 1))
Rarefied_amp_mean_rp%>% amp_heatmap(group_by = "Irrigation", facet_by = "WEEK",
tax_show = 25, tax_aggregate = "OTU",
tax_add = "Genus", plot_values_size = 3,
color_vector = c("White", "Brown")) +
theme(axis.text.y = element_text(size=10),strip.background = element_rect(fill="white", color = "black"),
strip.text = element_text(size =12), axis.text.x = element_text(angle = 0, hjust = 0.5))
heatmap_rp<-Rarefied_amp_mean_rp%>% amp_heatmap(group_by = "Irrigation", facet_by = "WEEK",
tax_show = 25, tax_aggregate = "OTU",
tax_add = "Genus", plot_values_size = 3,
color_vector = c("White", "Brown")) +
theme(axis.text.y = element_text(size=10),strip.background = element_rect(fill="white", color = "black"),
strip.text = element_text(size =12), axis.text.x = element_text(angle = 0, hjust = 0.5))
library(ggpubr)
x11(width = 7, height = 8)
ggarrange(annotated_proportions,heatmap_rp, ncol = 1 , labels = c("A","B"), heights = c(0.3,0.7))
ggsave("output/Fig3.png",dpi = 300)
dev.off()
